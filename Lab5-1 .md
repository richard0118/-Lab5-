# Lab-05\_1：圖書館資料庫設計

## 一、情境說明

為圖書館設計資料庫，需追蹤書籍、會員與借閱記錄。

### 初步收集資料：

* **書籍**：ISBN、書名、作者 (可能多位)、出版社名稱、出版社地址、出版年份、書籍類別。
* **會員**：會員卡號、姓名、地址、電話、Email。
* **借閱紀錄**：會員卡號、會員姓名、ISBN、書名、借閱日期、應還日期、實際歸還日期。

## 二、函數相依性分析

### 資料重複與異常情況分析：

* 一筆借閱紀錄可能重複紀錄書籍與會員資料，導致更新異常與冗餘。
* 書籍若有多位作者，會造成插入與刪除異常。
* 若未分離出版社資訊，更新出版社地址需更新多筆書籍資料。

### 函數相依性列表：

1. ISBN → 書名、出版年份、書籍類別、出版社名稱
2. 出版社名稱 → 出版社地址
3. ISBN + 作者姓名 → 作者排序（若需）
4. 會員卡號 → 會員姓名、會員地址、會員電話、會員Email
5. 借閱記錄ID → 會員卡號、ISBN、借閱日期、應還日期、實際歸還日期

（若無 ID 可由 ISBN + 會員卡號 + 借閱日期 組合）

## 三、正規化設計過程

### Step 1：初始關係

```
Borrow(會員卡號, 會員姓名, 會員地址, 會員電話, Email, ISBN, 書名, 出版年份, 書籍類別, 出版社名稱, 出版社地址, 作者姓名, 借閱日期, 應還日期, 實際歸還日期)
```

### Step 2：分解至 1NF（移除重複群組）

* 作者為多值屬性，需拆成獨立關係：`BookAuthor(ISBN, 作者姓名)`

### Step 3：分解至 2NF（消除部分相依）

* 書籍資料與會員資料不依賴於整個主鍵（假設主鍵為 ISBN + 會員卡號 + 借閱日期）
* 拆出：

  * `Book(ISBN, 書名, 出版年份, 書籍類別, 出版社名稱)`
  * `Member(會員卡號, 會員姓名, 會員地址, 會員電話, Email)`
  * `Publisher(出版社名稱, 出版社地址)`

### Step 4：分解至 3NF（消除傳遞相依）

* `出版社地址` 傳遞相依於 `ISBN` → 再分出 Publisher 資料表

### Step 5：確認是否符合 BCNF

* 所有決定因素皆為候選鍵，符合 BCNF。

## 四、最終資料表設計（ERD 對應）

* `Book(ISBN, 書名, 出版年份, 書籍類別, 出版社名稱)`
* `BookAuthor(ISBN, 作者姓名)`
* `Publisher(出版社名稱, 出版社地址)`
* `Member(會員卡號, 姓名, 地址, 電話, Email)`
* `Borrow(會員卡號, ISBN, 借閱日期, 應還日期, 實際歸還日期)`

## 五、實體關係圖（ERD）

* **Book** 1 --- \* **BookAuthor** (多位作者)
* **Book** N --- 1 **Publisher**
* **Member** 1 --- \* **Borrow**
* **Book** 1 --- \* **Borrow**

（若需 ERD 圖檔可另行繪製，建議使用 dbdiagram.io 或 Draw\.io）

## 六、設計說明與分析

* 所有函數相依皆對應至候選鍵，資料表無重複、插入與更新異常。
* 拆分出 `BookAuthor` 處理多作者情況。
* `Borrow` 表為橋接關係，紀錄借閱歷史，符合 BCNF。

---

> 本設計符合 3NF 並成功達成 BCNF，符合資料庫正規化原則，具備良好擴充與維護性。
